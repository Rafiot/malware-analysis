What is there
=============

A bunch of scripts I use to analize network traffic of malwares.

Setup a virtual env
===================

virtualenv virtenv

source virtenv/bin/activate


Install stuff
=============

All the system dependencies are installed in the install script, you'll also need dnschef

```
./install.sh

wget http://thesprawl.org/media/projects/dnschef-0.3.zip
unzip dnschef-0.3.tar.gz
```

Virtual machine configuration
=============================

* configure your VM as host only in the network configuration
* Give an static IP address to your virtual machine (192.168.56.3 for example)

Usage
=====

* Redirect traffic from VM: `iptables.sh` (change the `GUEST_IP` is needed).
* Run dnschef with `dnschef.sh` (change the path to dnschef, `NAMESERVER` and `INTERFACE_IP` is needed). Interface IP is the IP of your VM interface
* Run `mitmproxy.sh` to MiTM of HTTP and HTTPS traffic (look at the ssl configuration of mitmproxy if needed)
* Run `start-tcp.sh` to dump the rest of the traffic if you want
* (Optional) Open a website from the VM and see what happens.
